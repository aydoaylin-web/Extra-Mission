<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>🧩 Extra-Mission: Beep im Supermarkt</title>
<style>
  :root{
    --bg:#f6f7fb; --paper:#ffffff; --ink:#0f172a; --muted:#475569; --line:#e5e7eb;
    --accent:#0ea5e9; --ok:#16a34a; --warn:#dc2626; --soft:#eff6ff;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.55 system-ui,Segoe UI,Roboto,Inter,Arial}
  .container{max-width:980px;margin:28px auto;padding:0 16px}

  .topbar{display:flex;gap:12px;align-items:center;margin-bottom:12px;flex-wrap:wrap}
  .chip{display:inline-flex;align-items:center;gap:8px;background:var(--paper);border:1px solid var(--line);border-radius:12px;padding:8px 12px;box-shadow:0 1px 0 rgba(0,0,0,.03);user-select:none}

  .title{display:flex;align-items:center;gap:10px;font-weight:800;font-size:1.6rem;margin:6px 0 2px}
  .badge{width:28px;height:28px;display:grid;place-items:center;border-radius:8px;background:#d1fae5}

  .card{background:var(--paper);border:1px solid var(--line);border-radius:14px;padding:18px 20px;box-shadow:0 8px 20px rgba(15,23,42,.04);margin-bottom:18px}
  .muted{color:var(--muted)}
  .cta-row{display:flex;gap:12px;flex-wrap:wrap;margin-top:8px}

  .btn{background:var(--accent);border:1px solid var(--accent);color:#fff;border-radius:10px;padding:10px 14px;cursor:pointer}
  .btn:focus{outline:2px solid #93c5fd;outline-offset:2px}
  .btn.secondary{background:var(--paper);color:var(--ink);border-color:var(--line)}
  .btn:disabled{opacity:.6;cursor:not-allowed}

  .section{display:flex;align-items:center;gap:10px;margin:18px 0 8px;font-size:1.25rem;font-weight:800}
  .dot{width:10px;height:10px;border-radius:50%;background:#3b82f6}

  .table-wrap{overflow:auto;background:var(--paper);border:1px solid var(--line);border-radius:12px}
  table{width:100%;border-collapse:collapse;min-width:760px}
  th,td{padding:10px 12px;border-bottom:1px solid var(--line);text-align:left;vertical-align:top}
  th{background:#fafafa;font-weight:700}
  tr:last-child td{border-bottom:none}
  label{cursor:pointer}

  .feedback{display:none;background:#eef; padding:12px;border-radius:10px;margin-top:10px}
  .ok{color:var(--ok);font-weight:700}
  .warn{color:var(--warn);font-weight:700}

  textarea{width:100%;min-height:90px;margin-top:6px;border:1px solid var(--line);border-radius:10px;padding:10px;background:#fff}

  /* Tipps als Accordion */
  details.tip{border:1px solid var(--line);background:var(--paper);border-radius:12px;overflow:hidden;margin:12px 0}
  details.tip summary{list-style:none;cursor:pointer;padding:12px 14px;font-weight:700;display:flex;align-items:center;gap:8px}
  details.tip[open] summary{border-bottom:1px solid var(--line);background:var(--soft)}
  details.tip summary::marker{display:none}
  .tip-body{padding:12px 14px}

  /* Abschlussbox */
  #abschluss{background:#ecfdf5;border:1px solid #a7f3d0}

  /* Mobile-kompatibles DnD */
  .draggable { user-select: none; }
  .draggable.selected { outline: 3px solid #3b82f6; outline-offset: 2px; }
  .dropzone { touch-action: manipulation; }
</style>
</head>
<body>
  <div class="container">
    <div class="topbar">
      <div class="chip">🖨️ Drucken / PDF</div>
      <div class="chip">💾 Zwischenspeichern</div>
      <div class="chip">⬆️ Laden</div>
      <div class="chip">🧹 Alles löschen</div>
    </div>

    <div class="title"><div class="badge">🧩</div> Extra-Mission: Beep im Supermarkt</div>
    <div class="muted" style="margin-bottom:12px">Bonus-Aufgabe zum Escape Game </div>

    <div class="card">
      <p>Nachdem Beep in der letzten Mission bereits trainiert wurde, gefährliche von harmlosen Robotern zu unterscheiden, erhielt er nun seinen ersten richtigen Job in der Praxis: den Einsatz im Supermarkt. Dort soll er den Marktleiter unterstützen, indem er zuverlässig erkennt, welche Produkte frisch und welche abgelaufen sind.</p>
      <p>Doch die Lage spitzt sich zu: Beeps Entscheidungen wirken merkwürdig. Frische Ware wandert in den Müll, während abgelaufene Produkte unbehelligt im Regal bleiben. Offensichtlich sind in seinen Trainingsdaten Fehler verborgen, die er nun unbemerkt übernommen hat.</p>
      <p><b>Eure Mission:</b> Analysiert Beeps Trainingsdaten, deckt die Fehlklassifizierungen auf und formuliert anschließend eine mögliche Entscheidungsregel. Euer Feedback ist entscheidend, um Beep wieder zuverlässig arbeiten zu lassen.</p>
      <p>Bevor ihr loslegt, kommt der Marktleiter noch einmal zu euch und sagt leise: „Übrigens, unsere Lebensmittel sind alle mit einem <b>Mindesthaltbarkeitsdatum (MHD)</b> versehen. Außerdem sind sie mit Stickern versehen. <b>Sonderpreise</b> bekommen einen <b>roten Sticker 🔴</b>Die <b>grünen Sticker 🟢</b> zeigen nur, dass etwas <b>Bio</b> ist.“</p>

      <div class="cta-row"></div>
    </div>

    <div class="section"><span class="dot"></span> Teil 1 – Beeps Entscheidungen prüfen</div>
    <p class="muted"><b>Auftrag:</b> Jetzt geht es an die Analyse! Schaut euch zunächst genau an, welche Produkte Beep falsch klassifiziert hat. Geht seine Entscheidungen Schritt für Schritt durch und überprüft, an welchen Stellen Fehler passiert sind. Setzt ein Häkchen bei allen Fehlentscheidungen, die ihr findet. Achtung: Es gibt genau vier Fehler!</p>

    <div class="table-wrap">
      <table id="t1">
        <thead>
          <tr>
            <th style="width:60px">Nr.</th>
            <th style="width:36%">Produktbeschreibung</th>
            <th>Beeps Entscheidung</th>
            <th style="width:120px">Fehler?</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>1</td><td>🥛 Joghurt mit 🔴 Sonderpreis, MHD: 15.01.2026</td><td>abgelaufen</td>
            <td><label><input type="checkbox" data-correct="true"> markieren</label></td></tr>
          <tr><td>2</td><td>🥛 Milch (ohne Sticker), MHD: 24.08.2025 (gestern)</td><td>abgelaufen</td>
            <td><label><input type="checkbox" data-correct="false"> markieren</label></td></tr>
          <tr><td>3</td><td>🧃 Saft mit 🟢 Bio, MHD: 10.05.2026</td><td>frisch</td>
            <td><label><input type="checkbox" data-correct="false"> markieren</label></td></tr>
          <tr><td>4</td><td>🍞 Brot mit 🔴 Sonderpreis, heute frisch gebacken</td><td>abgelaufen</td>
            <td><label><input type="checkbox" data-correct="true"> markieren</label></td></tr>
          <tr><td>5</td><td>🧀 Käse (ohne Sticker), MHD: 01.11.2023</td><td>abgelaufen</td>
            <td><label><input type="checkbox" data-correct="false"> markieren</label></td></tr>
          <tr><td>6</td><td>🍎 Obstschale mit 🔴 Sonderpreis, Lieferung heute</td><td>abgelaufen</td>
            <td><label><input type="checkbox" data-correct="true"> markieren</label></td></tr>
          <tr><td>7</td><td>🧈 Butter mit 🟢 Bio, MHD: 01.03.2026</td><td>frisch</td>
            <td><label><input type="checkbox" data-correct="false"> markieren</label></td></tr>
          <tr><td>8</td><td>🥩 Wurst (ohne Sticker), MHD: 30.09.2022</td><td>abgelaufen</td>
            <td><label><input type="checkbox" data-correct="false"> markieren</label></td></tr>
          <tr><td>9</td><td>🍪 Kekse mit 🔴 Sonderpreis, MHD: 31.12.2026</td><td>abgelaufen</td>
            <td><label><input type="checkbox" data-correct="true"> markieren</label></td></tr>
          <tr><td>10</td><td>🥕 Gemüse (regional), Ernte heute</td><td>frisch</td>
            <td><label><input type="checkbox" data-correct="false"> markieren</label></td></tr>
        </tbody>
      </table>
    </div>

    <button class="btn" type="button" id="auswerten" onclick="checkTeil1()">✅ Auswerten</button>
    <div id="feedback1" class="feedback"></div>

    <div class="section"><span class="dot"></span> Teil 2 - Beep's falsche Regel identifizeiren </div>
    <p class="muted"><b>Auftrag:</b> Nun habt ihr erkannt, welche Lebensmittel Beep falsch klassifiziert hat. Dabei fällt euch auf: Das ist kein Zufall! Beep folgt lediglich einer Regel, die ihm seine Trainingsdaten vorgegeben haben. Schaut euch deshalb noch einmal seine Klassifizierungen genau an und überlegt, nach welcher Regel Beep Lebensmittel als abgelaufen oder haltbar einordnet.</p>

    <details class="tip">
      <summary>💡 Tipp anzeigen</summary>
      <div class="tip-body">
        🔎 Achtet auf alles: <b>das MHD, die Sticker und Farben</b>. Welches Merkmal führt dazu, dass Beep ein Lebensmittel als <b>„abgelaufen“</b> einstuft? Vielleicht schaut Beep nicht aufs <b>MHD</b>, sondern auf etwas anderes aus seinen Trainingsdaten.
      </div>
    </details>

    <textarea id="hypothese" aria-label="Hypothese eingeben"></textarea>
    <button class="btn" type="button" id="checkHypo">✅ Prüfen</button>
    <div id="feedbackHypo" class="feedback"></div>

    <!-- ===== Teil 3: Beep reparieren (Supervised Learning) ===== -->
    <div class="section"><span class="dot"></span> Teil 3 – Beep reparieren (Supervised Learning)</div>
    <p class="muted"><b>Auftrag:</b> Ziehe die Input-Merkmale auf den richtigen Output, damit Beep die Produkte korrekt klassifiziert. Überlege, welche Merkmale für „abgelaufen“ und „frisch“ relevant sind.</p>

    <div class="dragdrop-container" style="display:flex; gap:50px; margin-bottom:20px;">
      <div style="flex:1">
        <h4>Input-Merkmale</h4>
        <div id="inputItems" style="display:flex; flex-direction:column; gap:10px;">
          <div class="draggable" draggable="true" data-output="abgelaufen" style="padding:8px; border:1px solid #ccc; border-radius:5px; background:#fef3c7; cursor:grab;">MHD abgelaufen</div>
          <div class="draggable" draggable="true" data-output="falsch" style="padding:8px; border:1px solid #ccc; border-radius:5px; background:#eff6ff; cursor:grab;">Roter Sticker</div>
          <div class="draggable" draggable="true" data-output="frisch" style="padding:8px; border:1px solid #ccc; border-radius:5px; background:#d1fae5; cursor:grab;">Frische Lieferung heute</div>
          <div class="draggable" draggable="true" data-output="falsch" style="padding:8px; border:1px solid #ccc; border-radius:5px; background:#fde68a; cursor:grab;">Grüner Sticker</div>
        </div>
        <div class="muted" style="font-size:.9rem;margin-top:6px;">Tipp: Doppelklick legt ein Item schnell zurück in „Input-Merkmale“.</div>
      </div>

      <div style="flex:1">
        <h4>Output</h4>
        <div id="dropAbgelaufen" class="dropzone" data-expected="abgelaufen" style="min-height:60px; border:2px dashed #f87171; padding:10px; border-radius:5px; margin-bottom:10px;">abgelaufen</div>
        <div id="dropFrisch" class="dropzone" data-expected="frisch" style="min-height:60px; border:2px dashed #34d399; padding:10px; border-radius:5px;">frisch</div>
      </div>
    </div>

    <button class="btn" type="button" id="check3Btn">✅ Beep reparieren</button>
    <button class="btn" type="button" id="reset3Btn" class="btn secondary" style="background:#64748b">↺ Zurücksetzen</button>
    <div id="feedback3" class="feedback" style="margin-top:10px;"></div>

    <!-- Abschluss -->
    <div id="abschluss" class="feedback">
      <b>Herzlichen Glückwunsch! 🎉</b><br><br>
      Nun habt ihr die Aufgabe erfolgreich beendet! Dabei habt ihr gelernt, warum <b>korrekte Trainingsdaten</b> im <b>Supervised Learning</b> entscheidend sind: Nur dann liefert ein überwachtes KI-Modell verlässliche Ergebnisse. Beep hat gezeigt, was passiert, wenn aus fehlerhaften Daten eine falsche Regel gelernt wird – die Vorhersagen werden systematisch falsch.<br><br>
      <b>Merke:</b> Ohne saubere Daten kein verlässliches Modell.
    </div>
  </div>

  <script>
  /* ===== Teil 1: max. 3 Versuche + Lösung nach dem 3. ===== */
  let t1Attempts = 0;
  const t1Max = 3;

  function lockTeil1(){
    document.querySelectorAll('input[type=checkbox][data-correct]').forEach(b => b.disabled = true);
    const btn = document.getElementById('auswerten');
    if (btn) btn.disabled = true;
  }

  function checkTeil1(){
    const boxes = document.querySelectorAll('input[type=checkbox][data-correct]');
    const fb = document.getElementById('feedback1');

    let allRight = true;
    let correctChecked = 0;

    boxes.forEach(box => {
      const shouldBeChecked = box.dataset.correct === "true";
      if (shouldBeChecked && box.checked) correctChecked++;
      if (box.checked !== shouldBeChecked) allRight = false;
    });

    t1Attempts++;
    fb.style.display = "block";

    if (allRight){
      fb.innerHTML = "✅ Super! Du hast alle vier Fehler <b>(1, 4, 6, 9)</b> korrekt erkannt.";
      lockTeil1();
      return;
    }

    if (t1Attempts < t1Max){
      fb.innerHTML =
        `❌ Nicht ganz. (<b>${t1Attempts}/${t1Max}</b> Versuche) ` +
        `Du hast <b>${correctChecked} von 4</b> korrekt markiert. ` +
        `Achte auf wiederkehrende Merkmale auf den Verpackungen.`;
      return;
    }

    fb.innerHTML =
      "❌ Nicht ganz.<br><b>Lösung:</b> Die falsch klassifizierten Fälle sind <b>1, 4, 6 und 9</b>. " +
      "Achte auf wiederkehrende Merkmale auf den Verpackungen.";
    lockTeil1();
  }

  /* ===== Teil 2: Hypothese mit 3 Versuchen (robust) ===== */
  (() => {
    const btn = document.getElementById('checkHypo');
    const ta  = document.getElementById('hypothese');
    const fb  = document.getElementById('feedbackHypo');

    if (!btn || btn.dataset.hooked === '1') return;  // Guard gegen doppelte Listener
    btn.dataset.hooked = '1';

    let attempts = 0;
    const MAX = 3;
    const solutionText = 'Beep nutzt fälschlich den roten 🔴 Sonderpreis-Sticker als Abgelaufen-Regel (statt das MHD).';

    function lock() {
      if (ta) ta.disabled = true;
      btn.disabled = true;
    }

    btn.addEventListener('click', () => {
      const txt = (ta?.value || '').toLowerCase();
      fb.style.display = 'block';

      const correct = txt.includes('rot') || txt.includes('sonderpreis');
      if (correct) {
        fb.innerHTML = '✅ Richtig! ' + solutionText;
        lock();
        return;
      }

      attempts += 1;

      if (attempts < MAX) {
        fb.innerHTML = `❌ Nicht ganz. Versuch ${attempts} von ${MAX}. Tipp: Schau dir die Bedeutung der roten Sticker an.`;
      } else {
        fb.innerHTML = `❌ Nicht ganz. <b>Musterlösung:</b> ${solutionText}`;
        lock();
      }
    });
  })();

  /* ===== Kombi-Drag&Drop: Desktop (drag) + Tablet/Handy (tap-to-move) ===== */
  (() => {
    const input = document.getElementById('inputItems');
    const dropA = document.getElementById('dropAbgelaufen');
    const dropF = document.getElementById('dropFrisch');
    const zones = [input, dropA, dropF];

    // Eindeutige IDs + Desktop-Drag aktivieren
    let counter = 0;
    document.querySelectorAll('.draggable').forEach(item => {
      if (!item.dataset.dragid) item.dataset.dragid = 'd' + (++counter);
      item.draggable = true;

      // Desktop: klassisches Drag & Drop
      item.addEventListener('dragstart', e => {
        const id = item.dataset.dragid;
        e.dataTransfer.setData('id', id);
        e.dataTransfer.setData('text/plain', id); // wichtig für Firefox
        e.dataTransfer.effectAllowed = 'move';
      });

      // Doppelklick = schnell zurück in den Input-Container
      item.addEventListener('dblclick', () => {
        input.appendChild(item);
        item.classList.remove('selected');
      });

      // Touch/Pointer/Maus: auswählen
      item.addEventListener('pointerdown', () => {
        document.querySelectorAll('.draggable.selected').forEach(el => el.classList.remove('selected'));
        item.classList.add('selected');
      });
      item.addEventListener('click', () => {
        document.querySelectorAll('.draggable.selected').forEach(el => el.classList.remove('selected'));
        item.classList.add('selected');
      });
    });

    // Zonen droppable
    zones.forEach(zone => {
      if (!zone) return;
      zone.addEventListener('dragover', e => e.preventDefault());
      zone.addEventListener('drop', e => {
        e.preventDefault();
        const id = e.dataTransfer.getData('id') || e.dataTransfer.getData('text/plain');
        if (!id) return;
        const node = document.querySelector(`.draggable[data-dragid="${id}"]`);
        if (node) {
          zone.appendChild(node);
          node.classList.remove('selected');
        }
      });

      // Click/Touch: ausgewähltes Element hierhin verschieben
      zone.addEventListener('pointerup', e => {
        const selected = document.querySelector('.draggable.selected');
        if (!selected) return;
        if (selected.contains(e.target)) return;
        zone.appendChild(selected);
        selected.classList.remove('selected');
      });
      zone.addEventListener('click', e => {
        const selected = document.querySelector('.draggable.selected');
        if (!selected) return;
        if (selected.contains(e.target)) return;
        zone.appendChild(selected);
        selected.classList.remove('selected');
      });
    });

    // Auswertung Teil 3 + Reset
    const check3 = document.getElementById('check3Btn');
    const reset3 = document.getElementById('reset3Btn');

    function evaluate(){
      const fb = document.getElementById('feedback3');
      const ab = document.getElementById('abschluss');
      let correct = true;

      const abgelaufenItems = Array.from(dropA.children).map(c => c.textContent.trim());
      if (abgelaufenItems.length !== 1 || abgelaufenItems[0] !== "MHD abgelaufen") correct = false;

      const frischItems = Array.from(dropF.children).map(c => c.textContent.trim());
      const expectedFrisch = ["Frische Lieferung heute"];
      if (frischItems.length !== expectedFrisch.length || expectedFrisch.some(x => !frischItems.includes(x))) correct = false;

      // Sticker dürfen in KEINER Output-Zone liegen
      const forbidden = ["Roter Sticker","Grüner Sticker"];
      const outputs = [...dropA.children, ...dropF.children].map(n => n.textContent.trim());
      if (outputs.some(txt => forbidden.includes(txt))) correct = false;

      fb.style.display = 'block';
      if (correct) {
        fb.className = 'feedback ok';
        fb.innerHTML = "✅ Perfekt! Beep hat die richtigen Regeln gelernt:<br>"
          + "• <b>abgelaufen</b>: MHD abgelaufen<br>"
          + "• <b>frisch</b>: Frische Lieferung heute<br>"
          + "• <i>Sticker sind irrelevant</i> und müssen im Input bleiben.";
        if (ab) ab.style.display = 'block';
      } else {
        fb.className = 'feedback err';
        fb.innerHTML = "❌ Noch nicht ganz richtig. Ziehe irrelevante Merkmale (Sticker) zurück in „Input-Merkmale“ und prüfe erneut.";
        if (ab) ab.style.display = 'none';
      }
    }

    function resetTeil3(){
      [...dropA.children, ...dropF.children].forEach(n => input.appendChild(n));
      const fb = document.getElementById('feedback3');
      if (fb){ fb.style.display='none'; fb.textContent=''; }
      document.querySelectorAll('.draggable.selected').forEach(n=>n.classList.remove('selected'));
    }

    if (check3 && !check3.dataset.hooked){
      check3.dataset.hooked = '1';
      check3.addEventListener('click', evaluate);
    }
    if (reset3 && !reset3.dataset.hooked){
      reset3.dataset.hooked = '1';
      reset3.addEventListener('click', resetTeil3);
    }
  })();
  </script>
</body>
</html>
